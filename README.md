# Grok图片/视频生成插件

- 服务支持前提：`搭建Grok2api`
- Grok2api搭建教程：`https://github.com/chenyme/grok2api`或`https://github.com/Tomiya233/grok2api`

## 功能特性

- 🎬 **图生视频**：根据图片和文字提示生成视频
- 🎨 **图像生成**：支持文生图和图生图功能
- 🔄 **自动重试**：API请求失败时自动重试
- 🧹 **自动清理**：发送完成后自动清理本地缓存文件，不占用磁盘空间

## 使用方法

1. 发送一张图片
2. 引用该图片发送命令：`/视频 <提示词>` `/画图 <提示词>`

## 配置说明

- **server_url**: Grok2API服务器地址
- **model_id**: 视频生成模型ID（默认：grok-imagine-0.9）
- **image_model_id**: 图片生成模型ID（默认：grok-4.1-thinking）
- **api_key**: Grok2API-Key（API密钥）


## 技术实现

### API调用
插件使用Grok的 `/v1/chat/completions` 接口，发送包含图片和文字的请求。

### 资源处理
- **异步处理**：图片解码、裁剪等CPU密集型操作在线程池中运行，防止阻塞Bot主进程。
- **自动下载**：自动解析API响应中的媒体URL并下载。
- **自动清理**：文件发送成功或失败后，都会自动删除本地临时文件。

### 错误处理
- 完善的异常捕获和错误提示
- 自动重试机制（针对 429 限流等情况优化）
- 超时保护

## 注意事项

1. **API限制**：Grok视频生成有403限制，需要正确配置API密钥。
2. **处理时间**：视频生成需要较长时间，请耐心等待。
3. **网络要求**：需要稳定的网络连接下载生成的媒体文件。
4. **存储空间**：本插件默认**不保留**生成的历史文件，发送后即刻删除，无需担心磁盘占用。


